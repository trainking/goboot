# 设计思想

这套脚手架的设计目标，是为了整合开发中常用一些通用模板。

## 目标

设计目标是，实现**多实例的分布式服务器**实现。主要设计到以下方面：

1. 分层的代码结构设计
2. 可靠的内部通信机制
3. 服务发现和负载均衡
4. 支持多种协议的API
5. 自动化实例部署
6. 覆盖所有实例的监控和链路追踪

## 路线

### 1. 分层的代码结构设计


从实例的层面来看，可以分为两个层次：

- API层：负责提供给外部调用接口
- Service层：负责完成具体业务逻辑

> **所有外部应用都通过调用API层，来获得Service层提供的功能**

所有，运行起来，我们可以得到API实例和Service实例，API实例通过**ETCD**发现Service实例，通过gRPC调用。

#### API

**API**可以是一个抽象概念，指代应用程序调用接口。他的设计目标，屏蔽多种协议（如 HTTP, Websocket，自定义协议）调用，本身不实现业务细节，它要做的事：

1. 定义使用哪种通信协议
2. 定义接口路由，数据结构
3. 拆解业务调用，调用到指定的Service
4. 鉴权/用户缓存
5. 限流/熔断

具体内容，查看[API](./API.md)

### Service

**Service**是基于`gRPC`的微服务，它的作用是主要是**管理逻辑，链接数据**。它要做的事：

1. 动态服务注册
2. 对数据层的调用
3. 逻辑代码抽象出来

具体内容，查看[Service](./Servcie.md)

### 2.可靠的内部通信机制

内部通信使用gRPC来实现。gRPC的优势是：

1. 跨语言兼容
2. 有足够多的开源实现
